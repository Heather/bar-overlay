diff -crb old/cnijfilter-source-3.20-1/cnijfilter/src/bjfimage.c new/cnijfilter-source-3.20-1/cnijfilter/src/bjfimage.c
*** old/cnijfilter-source-3.20-1/cnijfilter/src/bjfimage.c	2009-03-26 05:11:05.000000000 +0000
--- new/cnijfilter-source-3.20-1/cnijfilter/src/bjfimage.c	2012-05-07 19:11:24.387016491 +0100
***************
*** 945,952 ****
  	short			tmpformat;
  	short			retbyte = 0;
  	short			bpp = 3;
! 	long			width = 0;
! 	long			length = 0;
  	long			maxvalue = 0;
  	long			rstep = 0;
  	long			RasterLength = 0;
--- 945,952 ----
  	short			tmpformat;
  	short			retbyte = 0;
  	short			bpp = 3;
! 	png_uint_32		width = 0;
! 	png_uint_32		length = 0;
  	long			maxvalue = 0;
  	long			rstep = 0;
  	long			RasterLength = 0;
***************
*** 1574,1580 ****
  		goto onErr;
  	}
  
! 	if (setjmp (png_p->jmpbuf))
  	{
  		png_destroy_read_struct(&png_p, &info_p, (png_infopp)NULL);
  		goto onErr;
--- 1574,1580 ----
  		goto onErr;
  	}
  
! 	if (setjmp (png_jmpbuf(png_p)))
  	{
  		png_destroy_read_struct(&png_p, &info_p, (png_infopp)NULL);
  		goto onErr;

